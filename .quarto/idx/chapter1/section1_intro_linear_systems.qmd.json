{"title":"1.1 Introduction to Linear Systems","markdown":{"yaml":{"title":"1.1 Introduction to Linear Systems","author":"Jason R. Wilson","format":"html","jupyter":"python3"},"headingText":"Linear Equations","containsRefs":false,"markdown":"\n\n\nThe solution set of the equation\n\n$$\nx + 2y = 1\n$$\n\nis a **line** in the $xy$-plane.\n\n```{python}\n#| label: fig-line-2xplusy\n#| fig-cap: \"The line $x + 2y = 1$\"\n#| cache: true\n#| echo: false\nimport numpy as np\nimport matplotlib.pyplot as plt\nfig = plt.figure(figsize=(6, 4))\nx = np.linspace(-4, 4, 200)\ny = 1 - (1/2) * x\nplt.axis('equal')\nplt.plot(x, y, label=r\"$x + 2y = 1$\")\nplt.axhline(0, color='gray', lw=0.5)\nplt.axvline(0, color='gray', lw=0.5)\nplt.grid(True)\nplt.title(\"Line in $\\mathbb{R}^2$\")\nplt.xlabel(\"x\",fontsize=14)\nplt.ylabel(\"y\",rotation=0,fontsize=14)\nplt.legend()\nplt.show()\n```\n\nThe solution set of the equation\n\n$$\nx + y + z = 2\n$$\n\nis a **plane** in $\\mathbb{R}^3$.\n\n```{python}\n#| label: fig-plane-xyz\n#| fig-cap: \"The plane $x + y + z = 2$\"\n#| cache: true\n#| echo: false\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom mpl_toolkits.mplot3d import Axes3D\n\nfig = plt.figure(figsize=(5, 5))\nax = fig.add_subplot(111, projection='3d')\n\n# Create grid\nx = np.linspace(-5, 5, 20)\ny = np.linspace(-5, 5, 20)\nxx, yy = np.meshgrid(x, y)\nzz = 2 - xx - yy\n\n# Plot surface\nsurf = ax.plot_surface(xx, yy, zz, rstride=1, cstride=1, alpha=0.8,\n                       cmap='Blues', edgecolor='k', linewidth=0.3)\n\n# Axes labels\nax.set_xlabel('x', labelpad=1,fontsize=14)\nax.set_ylabel('y', labelpad=1,fontsize=14)\nax.set_zlabel('z', labelpad=1,fontsize=14)\nax.set_title('Plane in $\\mathbb{R}^3$', pad=1)\n\n# Improve layout and preserve labels\nax.tick_params(labelsize=10)\nfig.tight_layout()\n\nplt.show()\n```\n\nThe above line equation and plane equation are examples of \n*linear equations*.\n\n::: {.callout-note title=\"Definition: Linear Equation\"}\nFor given constants $a_1, a_2, \\ldots, a_n$ and $b$ in $\\mathbb{R}$ we call\n\n$$\na_1 x_1 + a_2 x_2 + \\cdots + a_n x_n = b\n$$\na **linear equation** in the variables $x_1, x_2,\n\\ldots, x_n$.  \n:::\n\nFor $n > 3$, graph of a linear equation is called a *hyperplane* in\n$n$-dimensional space.\n\n**Exercise:** Which of the following are linear equations?\n\n- $2x_1 + 3x_2 = 4$  \n- $x_1 - x_1 x_2 = 2$  \n- $y_1 - 4y_2 + 2y_3 = 0$  \n- $w - x - 3y + z = 5$  \n- $x - 2\\sqrt{y} = 4$\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\nLinear:\n\n- $2x_1 + 3x_2 = 4$  \n- $y_1 - 4y_2 + 2y_3 = 0$  \n- $w - x - 3y + z = 5$\n\nNonlinear:\n\n- $x_1 - x_1 x_2 = 2$ (contains product of variables)  \n- $x - 2\\sqrt{y} = 4$ (contains square root of a variable)\n:::\n\n### Cubic Polynomial Interpolation\n\nLet's consider a data science application where linear equations with more 3 variables arise. \nConsider the problem of finding \nthe cubic polynomial(s)\n\n$$\nf(x) = \\beta_1 + \\beta_2 x + \\beta_3 x^2 + \\beta_4 x^3\n$$\n\nwith a graph that passes through the following points in the $xy$-plane:\n\n$$\n(-2, 3), \\quad (-1, -6), \\quad (1, 0), \\quad (3, -2)\n$$\n\nWe seek values of the coefficients\n$\\beta_1, \\beta_2, \\beta_3, \\beta_4$ such that $f(x)$ satisfies:\n\n$$\nf(-2) = 3, \\qquad f(-1) = -6, \\qquad f(1) = 0, \\qquad f(3) = -2\n$$\n\nFor $f(-2) = 3$ we plug $x = -2$ \ninto $f(x) = \\beta_1 + \\beta_2 x + \\beta_3 x^2 + \\beta_4 x^3$ to get the\nlinear equation:\n\n$$\n\\beta_1 - 2 \\beta_2 + 4 \\beta_3 - 8 \\beta_4 = 3\n$$\n\n**Exercise:** What linear equations do we get when plugging in the remaining 3 constraints $f(-1) = -6$, $f(1) = 0$, and $f(3) = -2$?\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\nFor $f(-1) = -6$, \n\n$$\n\\beta_1 - \\beta_2 + \\beta_3 - \\beta_4 = -6\n$$\n\nFor $f(1) = 0$, \n\n$$\n\\beta_1 + \\beta_2 + \\beta_3 + \\beta_4 = 0\n$$\n\nFor $f(3) = -2$, \n\n$$\n\\beta_1 + 3\\beta_2 + 9\\beta_3 + 27\\beta_4 = -2\n$$\n:::\n\nSince the cubic must pass through all 4 points, \nour unknown coefficients $\\beta_1, \\beta_2, \\beta_3, \\beta_4$ must\nsatisfy the following system of equations:\n\n$$\n\\begin{array}{ccccccccc}\n\\beta_1 & - & 2 \\beta_2 & + & 4 \\beta_3 & - & 8 \\beta_4 & = & 3 \\\\\n\\beta_1 & - & \\beta_2 & + & \\beta_3 & - & \\beta_4 & = & -6 \\\\\n\\beta_1 & + & \\beta_2 & + & \\beta_3 & + & \\beta_4 & = & 0 \\\\\n\\beta_1 & + & 3\\beta_2 & + & 9\\beta_3 & + & 27 \\beta_4 &= & -2\n\\end{array}\n$$\n\nWe call a system of linear equations a *linear system*.  One can show that the above linear system has the \n*unique solution* given by:\n\n$$\n\\beta_1 = -5, \\quad \\beta_2 = 4, \\quad \\beta_3 = 2, \\quad \\beta_4 = -1\n$$\n\n**Exercise:** Verify by plugging in that the above assignment of variables is a solution of the linear system.\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n\\begin{array}{ccccccccc}\n-5 & - & 2 (4) & + & 4 (2) & - & 8 (-1) & = & 3 \\\\\n-5 & - & 4 & + & 2 & - & -1 & = & -6 \\\\\n-5 & + & 4 & + & 2 & + & -1 & = & 0 \\\\\n-5 & + & 3 (4) & + & 9 (2) & + & 27 (-1) &= & -2\n\\end{array}\n$$\n\n:::\n\nSince there exists a solution, we call the\nlinear system *consistent*.\nSince the linear \nsystem has a *unique* solution, \n\n$$f(x) = -5 + 4x + 2x^2 - x^3$$\n\nis the *unique* cubic \npolynomial with a graph that passes through the\ngiven points.\n\n\n```{python}\n#| label: fig-cubic-solution\n#| fig-cap: \"Fitted cubic polynomial\"\n#| cache: true\n#| echo: false\ndef f(x): return -5 + 4*x + 2*x**2 - x**3\n\npoints = [(-2, 3), (-1, -6), (1, 0), (3, -2)]\nx_pts, y_pts = zip(*points)\nx_vals = np.linspace(-3, 4, 300)\ny_vals = f(x_vals)\nplt.figure(figsize=(6, 4))\nplt.plot(x_vals, y_vals, label=r\"$f(x) = -5 + 4x + 2x^2 - x^3$\")\nplt.scatter(x_pts, y_pts, color=\"black\", zorder=5)\nplt.legend()\nplt.grid(True)\nplt.title(\"Interpolating Cubic Polynomial\")\nplt.xlabel(\"x\",fontsize=14)\nplt.ylabel(\"f(x)\",rotation=0,fontsize=14)\nplt.show()\n```\n\nAs we will see in the next example, not all linear systems have a single unique solution.\n\n### Underdetermined Linear System\n\nConsider the problem of finding \nthe cubic polynomial(s)\n\n$$\nf(x) = \\beta_1 + \\beta_2 x + \\beta_3 x^2 + \\beta_4 x^3\n$$\n\nwith a graph that passes through the following points in the $xy$-plane:\n\n$$\n(-2, 3), \\quad (-1, -6), \\quad (1, 0)\n$$\n\nSince these 3 points are the first 3 points of the previous example, \nour coefficients $\\beta_1, \\beta_2, \\beta_3, \\beta_4$ must \nsatisfy only the first 3 equations of the previous linear system:\n\n$$\n\\begin{array}{ccccccccc}\n\\beta_1 & - & 2 \\beta_2 & + & 4 \\beta_3 & - & 8 \\beta_4 & = & 3 \\\\\n\\beta_1 & - & \\beta_2 & + & \\beta_3 & - & \\beta_4 & = & -6 \\\\\n\\beta_1 & + & \\beta_2 & + & \\beta_3 & + & \\beta_4 & = & 0\n\\end{array}\n$$\n\nWe call the linear system \n*underdetermined* since \nthe number\nof variables (unknowns) is larger than the number of \nequations (constraints).  One can show that linear system has an *infinite* number of solutions which are given by:\n\n$$\n\\beta_1 = -7 -2t, \\qquad \\beta_2 = 3 - t, \\qquad \\beta_3 = 4 + 2t, \\qquad \\beta_4 = t\n$$\n\nwhere $t$ is any real number.\n\n**Exercise:** Verify by plugging in that the above assignment of variables is a solution of the linear system for any choice of $t$.  \n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n\\begin{array}{ccccccccc}\n(-7-2t) & - & 2 (3-t) & + & 4 (4+2t) & - & 8 t & = & 3 \\\\\n(-7-2t) & - & (3-t) & + & (4+2t) & - & t & = & -6 \\\\\n(-7-2t) & + & (3-t) & + & (4+2t) & + & t & = & 0 \\\\\n\\end{array}\n$$\n\n:::\n\nSince the linear system has an\ninfinite number of solutions, there are an *infinite*\nnumber of cubic \npolynomials with a graph that passes through the given points.  The figure below shows \nthree such cubic polynomials\ncorresponding to $t = -1$, $t = 0$, and $t = 1$.  \n\n```{python}\n#| label: fig-underdetermined-family\n#| fig-cap: \"Cubic fits for $t = -1, 0, 1$\"\n#| cache: true\n#| echo: false\ndef cubic_family(x, t):\n    b1 = -7 - 2*t\n    b2 = 3 - t\n    b3 = 4 + 2*t\n    b4 = t\n    return b1 + b2*x + b3*x**2 + b4*x**3\n\nx_vals = np.linspace(-3, 2, 200)\nt_vals = [-1, 0, 1]\ncolors = ['blue', 'green', 'orange']\nlabels = [r\"$t = -1$\", r\"$t = 0$\", r\"$t = 1$\"]\n\nplt.figure(figsize=(6, 4))\nfor t, c, lbl in zip(t_vals, colors, labels):\n    plt.plot(x_vals, cubic_family(x_vals, t), label=lbl, color=c)\nplt.scatter(x_pts[:3], y_pts[:3], color='black', zorder=5)\nplt.legend()\nplt.grid(True)\nplt.title(\"Family of Cubics Through 3 Points\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.show()\n```\n\nAs we will see in the next example, some linear systems have *no* solutions.\n\n### Overdetermined Linear System\n\nConsider the problem of finding \nthe quadratic polynomial(s) \n\n$$\nf(x) = \\beta_1 + \\beta_2 x + \\beta_3 x^2\n$$\n\nwith a graph that passes through the $4$ points \n\n$$\n(-2,3), \\qquad (-1, -6), \\qquad (1,0), \\qquad (3,-2)\n$$\n\nFinding the quadratic polynomial(s) corresponds to finding \nsolutions to the linear system:\n\n$$\n\\begin{array}{ccccccc}\n\\beta_1 & - & 2 \\beta_2 & + & 4 \\beta_3 & = & 3 \\\\\n\\beta_1 & - & \\beta_2 & + & \\beta_3 & = & -6 \\\\\n\\beta_1 & + & \\beta_2 & + & \\beta_3 & = & 0 \\\\\n\\beta_1 & + & 3\\beta_2 & + & 9\\beta_3 & = & -2\n\\end{array}\n$$\n\nWe call the linear system \n*overdetermined* since the number\nof equations (constraints) is larger than the number of \nvariables (unknowns).\n\n**Exercise:** Show that $\\beta_2 = 3$ by subtracting the second equation from the third equation.\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n0 - (-6) = (\\beta_1 + \\beta_2 + \\beta_3) - ( \\beta_1 - \\beta_2 +\n\\beta_3) = 2 \\beta_2\n$$\n\nWe conclude that $\\beta_2 = 3$.\n:::\n\n**Exercise:** Show that $\\beta_3 = -4$ by subtracting the first equation from the fourth equation and using the fact that $\\beta_2 = 3$.  \n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n-2 - 3 = (\\beta_1 + 3 \\beta_2 + 9 \\beta_3) - (\\beta_1 - 2 \\beta_2 + 4\n\\beta_3 ) = 5 \\beta_2 + 5 \\beta_3 = 15 + 5 \\beta_3\n$$\n\nWe conclude that $\\beta_3 = -4$.\n:::\n\n**Exercise:** Show that $\\beta_1 = 25$ by plugging \n$\\beta_2 = 3$ and $\\beta_3 = -4$ into the \nfirst equation.\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n3 = \\beta_1 - 2 \\beta_2 + 4 \\beta_3 = \\beta_1 - 6 - 16\n$$\n\nWe conclude that $\\beta_1 = 25$.\n:::\n\nPlugging $\\beta_1 = 25$, $\\beta_2 = 3$, and $\\beta_3 = -4$ into the second equation gives:\n\n$$\n\\beta_1 - \\beta_2 + \\beta_3 = 25 - 3 - 4 = 18 \\neq -6\n$$\n\nWe conclude that the linear system how *no solution* \nand thus *no quadratic polynomial* has a graph that passes \nthrough the given points.\nSince there exists no solution, we call the\nlinear system *inconsistent*.\n\n### General Linear Systems\n\nNow that we have seen specific example of linear sytems, let's look at the general definition:\n\n::: {.callout-note title=\"Definition: Linear System\"}\n\nA system of $m$ linear equations in $n$ variables $x_1, x_2, \\ldots, x_n$ is called an $m \\times n$ **linear system**.\n\n$$\n\\begin{aligned}\na_{11}x_1 + a_{12}x_2 + \\cdots + a_{1n}x_n &= b_1 \\\\\na_{21}x_1 + a_{22}x_2 + \\cdots + a_{2n}x_n &= b_2 \\\\\n\\vdots \\\\\na_{m1}x_1 + a_{m2}x_2 + \\cdots + a_{mn}x_n &= b_m\n\\end{aligned}\n$$\n\n- An **assignment** of the variables $x_1, x_2, \\ldots, x_n$ is a **solution** of the linear system if it satisfies **all** $m$ equations simultaneously.  \n- A linear system that has **at least one solution** is called **consistent**.  \n- A linear system with **no solution** is called **inconsistent**.  \n- A system is **underdetermined** if there are **more variables than equations** ($n > m$).  \n- A system is **overdetermined** if there are **more equations than variables** ($m > n$).  \n\n:::\n\nHere are some questions about linear systems that we will soon be able to answer.\n\n1. What are the possible sizes of the solution set of a linear system?\n2. How do we tell if a linear system is consistent?\n3. How can we tell if a consistent linear system has a unique solution?\n4. How do we find all solutions of a consistent linear system?\n5. How can we find an approximate solution to an inconsistent linear system?\n\nThe answers to these questions are not obvious.  For example, given what we have seen so far about linear systems it seems intuitive to conclude that any overdetermined linear system is inconsistent.  Since the following linear system is consistent with solution $x = 1$, $y=1$, \nthat intuition is incorrect. \n\n$$\n\\begin{aligned}\nx + y &= 2 \\\\\nx - y &= 0 \\\\\n2x + 3y &= 5\n\\end{aligned}\n$$\n\nTo answer these questions and more we will first need to learn about *matrices* and *vectors*.\nFor example, a linear system \ncan be written much more consisely using matrices and vectors as:\n\n$$\nA \\mathbf{x} = \\mathbf{b}\n$$\n\nwhere:\n\n$$\nA = \\begin{bmatrix}\na_{11} & a_{12} & \\cdots & a_{1n} \\\\\na_{21} & a_{22} & \\cdots & a_{2n} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\na_{m1} & a_{m2} & \\cdots & a_{mn}\n\\end{bmatrix}, \\quad\n\\mathbf{x} =\n\\begin{bmatrix}\nx_1 \\\\\nx_2 \\\\\n\\vdots \\\\\nx_n\n\\end{bmatrix}, \\quad\n\\mathbf{b} =\n\\begin{bmatrix}\nb_1 \\\\\nb_2 \\\\\n\\vdots \\\\\nb_m\n\\end{bmatrix}\n$$\n\nand \n\n- $A$ is called the *coefficient matrix*\n- $\\mathbf{x}$ is called the *solution vector*\n- $\\mathbf{b}$ is called the *right-and-side vector*\n","srcMarkdownNoYaml":"\n\n### Linear Equations\n\nThe solution set of the equation\n\n$$\nx + 2y = 1\n$$\n\nis a **line** in the $xy$-plane.\n\n```{python}\n#| label: fig-line-2xplusy\n#| fig-cap: \"The line $x + 2y = 1$\"\n#| cache: true\n#| echo: false\nimport numpy as np\nimport matplotlib.pyplot as plt\nfig = plt.figure(figsize=(6, 4))\nx = np.linspace(-4, 4, 200)\ny = 1 - (1/2) * x\nplt.axis('equal')\nplt.plot(x, y, label=r\"$x + 2y = 1$\")\nplt.axhline(0, color='gray', lw=0.5)\nplt.axvline(0, color='gray', lw=0.5)\nplt.grid(True)\nplt.title(\"Line in $\\mathbb{R}^2$\")\nplt.xlabel(\"x\",fontsize=14)\nplt.ylabel(\"y\",rotation=0,fontsize=14)\nplt.legend()\nplt.show()\n```\n\nThe solution set of the equation\n\n$$\nx + y + z = 2\n$$\n\nis a **plane** in $\\mathbb{R}^3$.\n\n```{python}\n#| label: fig-plane-xyz\n#| fig-cap: \"The plane $x + y + z = 2$\"\n#| cache: true\n#| echo: false\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom mpl_toolkits.mplot3d import Axes3D\n\nfig = plt.figure(figsize=(5, 5))\nax = fig.add_subplot(111, projection='3d')\n\n# Create grid\nx = np.linspace(-5, 5, 20)\ny = np.linspace(-5, 5, 20)\nxx, yy = np.meshgrid(x, y)\nzz = 2 - xx - yy\n\n# Plot surface\nsurf = ax.plot_surface(xx, yy, zz, rstride=1, cstride=1, alpha=0.8,\n                       cmap='Blues', edgecolor='k', linewidth=0.3)\n\n# Axes labels\nax.set_xlabel('x', labelpad=1,fontsize=14)\nax.set_ylabel('y', labelpad=1,fontsize=14)\nax.set_zlabel('z', labelpad=1,fontsize=14)\nax.set_title('Plane in $\\mathbb{R}^3$', pad=1)\n\n# Improve layout and preserve labels\nax.tick_params(labelsize=10)\nfig.tight_layout()\n\nplt.show()\n```\n\nThe above line equation and plane equation are examples of \n*linear equations*.\n\n::: {.callout-note title=\"Definition: Linear Equation\"}\nFor given constants $a_1, a_2, \\ldots, a_n$ and $b$ in $\\mathbb{R}$ we call\n\n$$\na_1 x_1 + a_2 x_2 + \\cdots + a_n x_n = b\n$$\na **linear equation** in the variables $x_1, x_2,\n\\ldots, x_n$.  \n:::\n\nFor $n > 3$, graph of a linear equation is called a *hyperplane* in\n$n$-dimensional space.\n\n**Exercise:** Which of the following are linear equations?\n\n- $2x_1 + 3x_2 = 4$  \n- $x_1 - x_1 x_2 = 2$  \n- $y_1 - 4y_2 + 2y_3 = 0$  \n- $w - x - 3y + z = 5$  \n- $x - 2\\sqrt{y} = 4$\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\nLinear:\n\n- $2x_1 + 3x_2 = 4$  \n- $y_1 - 4y_2 + 2y_3 = 0$  \n- $w - x - 3y + z = 5$\n\nNonlinear:\n\n- $x_1 - x_1 x_2 = 2$ (contains product of variables)  \n- $x - 2\\sqrt{y} = 4$ (contains square root of a variable)\n:::\n\n### Cubic Polynomial Interpolation\n\nLet's consider a data science application where linear equations with more 3 variables arise. \nConsider the problem of finding \nthe cubic polynomial(s)\n\n$$\nf(x) = \\beta_1 + \\beta_2 x + \\beta_3 x^2 + \\beta_4 x^3\n$$\n\nwith a graph that passes through the following points in the $xy$-plane:\n\n$$\n(-2, 3), \\quad (-1, -6), \\quad (1, 0), \\quad (3, -2)\n$$\n\nWe seek values of the coefficients\n$\\beta_1, \\beta_2, \\beta_3, \\beta_4$ such that $f(x)$ satisfies:\n\n$$\nf(-2) = 3, \\qquad f(-1) = -6, \\qquad f(1) = 0, \\qquad f(3) = -2\n$$\n\nFor $f(-2) = 3$ we plug $x = -2$ \ninto $f(x) = \\beta_1 + \\beta_2 x + \\beta_3 x^2 + \\beta_4 x^3$ to get the\nlinear equation:\n\n$$\n\\beta_1 - 2 \\beta_2 + 4 \\beta_3 - 8 \\beta_4 = 3\n$$\n\n**Exercise:** What linear equations do we get when plugging in the remaining 3 constraints $f(-1) = -6$, $f(1) = 0$, and $f(3) = -2$?\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\nFor $f(-1) = -6$, \n\n$$\n\\beta_1 - \\beta_2 + \\beta_3 - \\beta_4 = -6\n$$\n\nFor $f(1) = 0$, \n\n$$\n\\beta_1 + \\beta_2 + \\beta_3 + \\beta_4 = 0\n$$\n\nFor $f(3) = -2$, \n\n$$\n\\beta_1 + 3\\beta_2 + 9\\beta_3 + 27\\beta_4 = -2\n$$\n:::\n\nSince the cubic must pass through all 4 points, \nour unknown coefficients $\\beta_1, \\beta_2, \\beta_3, \\beta_4$ must\nsatisfy the following system of equations:\n\n$$\n\\begin{array}{ccccccccc}\n\\beta_1 & - & 2 \\beta_2 & + & 4 \\beta_3 & - & 8 \\beta_4 & = & 3 \\\\\n\\beta_1 & - & \\beta_2 & + & \\beta_3 & - & \\beta_4 & = & -6 \\\\\n\\beta_1 & + & \\beta_2 & + & \\beta_3 & + & \\beta_4 & = & 0 \\\\\n\\beta_1 & + & 3\\beta_2 & + & 9\\beta_3 & + & 27 \\beta_4 &= & -2\n\\end{array}\n$$\n\nWe call a system of linear equations a *linear system*.  One can show that the above linear system has the \n*unique solution* given by:\n\n$$\n\\beta_1 = -5, \\quad \\beta_2 = 4, \\quad \\beta_3 = 2, \\quad \\beta_4 = -1\n$$\n\n**Exercise:** Verify by plugging in that the above assignment of variables is a solution of the linear system.\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n\\begin{array}{ccccccccc}\n-5 & - & 2 (4) & + & 4 (2) & - & 8 (-1) & = & 3 \\\\\n-5 & - & 4 & + & 2 & - & -1 & = & -6 \\\\\n-5 & + & 4 & + & 2 & + & -1 & = & 0 \\\\\n-5 & + & 3 (4) & + & 9 (2) & + & 27 (-1) &= & -2\n\\end{array}\n$$\n\n:::\n\nSince there exists a solution, we call the\nlinear system *consistent*.\nSince the linear \nsystem has a *unique* solution, \n\n$$f(x) = -5 + 4x + 2x^2 - x^3$$\n\nis the *unique* cubic \npolynomial with a graph that passes through the\ngiven points.\n\n\n```{python}\n#| label: fig-cubic-solution\n#| fig-cap: \"Fitted cubic polynomial\"\n#| cache: true\n#| echo: false\ndef f(x): return -5 + 4*x + 2*x**2 - x**3\n\npoints = [(-2, 3), (-1, -6), (1, 0), (3, -2)]\nx_pts, y_pts = zip(*points)\nx_vals = np.linspace(-3, 4, 300)\ny_vals = f(x_vals)\nplt.figure(figsize=(6, 4))\nplt.plot(x_vals, y_vals, label=r\"$f(x) = -5 + 4x + 2x^2 - x^3$\")\nplt.scatter(x_pts, y_pts, color=\"black\", zorder=5)\nplt.legend()\nplt.grid(True)\nplt.title(\"Interpolating Cubic Polynomial\")\nplt.xlabel(\"x\",fontsize=14)\nplt.ylabel(\"f(x)\",rotation=0,fontsize=14)\nplt.show()\n```\n\nAs we will see in the next example, not all linear systems have a single unique solution.\n\n### Underdetermined Linear System\n\nConsider the problem of finding \nthe cubic polynomial(s)\n\n$$\nf(x) = \\beta_1 + \\beta_2 x + \\beta_3 x^2 + \\beta_4 x^3\n$$\n\nwith a graph that passes through the following points in the $xy$-plane:\n\n$$\n(-2, 3), \\quad (-1, -6), \\quad (1, 0)\n$$\n\nSince these 3 points are the first 3 points of the previous example, \nour coefficients $\\beta_1, \\beta_2, \\beta_3, \\beta_4$ must \nsatisfy only the first 3 equations of the previous linear system:\n\n$$\n\\begin{array}{ccccccccc}\n\\beta_1 & - & 2 \\beta_2 & + & 4 \\beta_3 & - & 8 \\beta_4 & = & 3 \\\\\n\\beta_1 & - & \\beta_2 & + & \\beta_3 & - & \\beta_4 & = & -6 \\\\\n\\beta_1 & + & \\beta_2 & + & \\beta_3 & + & \\beta_4 & = & 0\n\\end{array}\n$$\n\nWe call the linear system \n*underdetermined* since \nthe number\nof variables (unknowns) is larger than the number of \nequations (constraints).  One can show that linear system has an *infinite* number of solutions which are given by:\n\n$$\n\\beta_1 = -7 -2t, \\qquad \\beta_2 = 3 - t, \\qquad \\beta_3 = 4 + 2t, \\qquad \\beta_4 = t\n$$\n\nwhere $t$ is any real number.\n\n**Exercise:** Verify by plugging in that the above assignment of variables is a solution of the linear system for any choice of $t$.  \n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n\\begin{array}{ccccccccc}\n(-7-2t) & - & 2 (3-t) & + & 4 (4+2t) & - & 8 t & = & 3 \\\\\n(-7-2t) & - & (3-t) & + & (4+2t) & - & t & = & -6 \\\\\n(-7-2t) & + & (3-t) & + & (4+2t) & + & t & = & 0 \\\\\n\\end{array}\n$$\n\n:::\n\nSince the linear system has an\ninfinite number of solutions, there are an *infinite*\nnumber of cubic \npolynomials with a graph that passes through the given points.  The figure below shows \nthree such cubic polynomials\ncorresponding to $t = -1$, $t = 0$, and $t = 1$.  \n\n```{python}\n#| label: fig-underdetermined-family\n#| fig-cap: \"Cubic fits for $t = -1, 0, 1$\"\n#| cache: true\n#| echo: false\ndef cubic_family(x, t):\n    b1 = -7 - 2*t\n    b2 = 3 - t\n    b3 = 4 + 2*t\n    b4 = t\n    return b1 + b2*x + b3*x**2 + b4*x**3\n\nx_vals = np.linspace(-3, 2, 200)\nt_vals = [-1, 0, 1]\ncolors = ['blue', 'green', 'orange']\nlabels = [r\"$t = -1$\", r\"$t = 0$\", r\"$t = 1$\"]\n\nplt.figure(figsize=(6, 4))\nfor t, c, lbl in zip(t_vals, colors, labels):\n    plt.plot(x_vals, cubic_family(x_vals, t), label=lbl, color=c)\nplt.scatter(x_pts[:3], y_pts[:3], color='black', zorder=5)\nplt.legend()\nplt.grid(True)\nplt.title(\"Family of Cubics Through 3 Points\")\nplt.xlabel(\"x\")\nplt.ylabel(\"f(x)\")\nplt.show()\n```\n\nAs we will see in the next example, some linear systems have *no* solutions.\n\n### Overdetermined Linear System\n\nConsider the problem of finding \nthe quadratic polynomial(s) \n\n$$\nf(x) = \\beta_1 + \\beta_2 x + \\beta_3 x^2\n$$\n\nwith a graph that passes through the $4$ points \n\n$$\n(-2,3), \\qquad (-1, -6), \\qquad (1,0), \\qquad (3,-2)\n$$\n\nFinding the quadratic polynomial(s) corresponds to finding \nsolutions to the linear system:\n\n$$\n\\begin{array}{ccccccc}\n\\beta_1 & - & 2 \\beta_2 & + & 4 \\beta_3 & = & 3 \\\\\n\\beta_1 & - & \\beta_2 & + & \\beta_3 & = & -6 \\\\\n\\beta_1 & + & \\beta_2 & + & \\beta_3 & = & 0 \\\\\n\\beta_1 & + & 3\\beta_2 & + & 9\\beta_3 & = & -2\n\\end{array}\n$$\n\nWe call the linear system \n*overdetermined* since the number\nof equations (constraints) is larger than the number of \nvariables (unknowns).\n\n**Exercise:** Show that $\\beta_2 = 3$ by subtracting the second equation from the third equation.\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n0 - (-6) = (\\beta_1 + \\beta_2 + \\beta_3) - ( \\beta_1 - \\beta_2 +\n\\beta_3) = 2 \\beta_2\n$$\n\nWe conclude that $\\beta_2 = 3$.\n:::\n\n**Exercise:** Show that $\\beta_3 = -4$ by subtracting the first equation from the fourth equation and using the fact that $\\beta_2 = 3$.  \n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n-2 - 3 = (\\beta_1 + 3 \\beta_2 + 9 \\beta_3) - (\\beta_1 - 2 \\beta_2 + 4\n\\beta_3 ) = 5 \\beta_2 + 5 \\beta_3 = 15 + 5 \\beta_3\n$$\n\nWe conclude that $\\beta_3 = -4$.\n:::\n\n**Exercise:** Show that $\\beta_1 = 25$ by plugging \n$\\beta_2 = 3$ and $\\beta_3 = -4$ into the \nfirst equation.\n\n::: {.callout-tip collapse=true title=\"Show Answer\"}\n\n$$\n3 = \\beta_1 - 2 \\beta_2 + 4 \\beta_3 = \\beta_1 - 6 - 16\n$$\n\nWe conclude that $\\beta_1 = 25$.\n:::\n\nPlugging $\\beta_1 = 25$, $\\beta_2 = 3$, and $\\beta_3 = -4$ into the second equation gives:\n\n$$\n\\beta_1 - \\beta_2 + \\beta_3 = 25 - 3 - 4 = 18 \\neq -6\n$$\n\nWe conclude that the linear system how *no solution* \nand thus *no quadratic polynomial* has a graph that passes \nthrough the given points.\nSince there exists no solution, we call the\nlinear system *inconsistent*.\n\n### General Linear Systems\n\nNow that we have seen specific example of linear sytems, let's look at the general definition:\n\n::: {.callout-note title=\"Definition: Linear System\"}\n\nA system of $m$ linear equations in $n$ variables $x_1, x_2, \\ldots, x_n$ is called an $m \\times n$ **linear system**.\n\n$$\n\\begin{aligned}\na_{11}x_1 + a_{12}x_2 + \\cdots + a_{1n}x_n &= b_1 \\\\\na_{21}x_1 + a_{22}x_2 + \\cdots + a_{2n}x_n &= b_2 \\\\\n\\vdots \\\\\na_{m1}x_1 + a_{m2}x_2 + \\cdots + a_{mn}x_n &= b_m\n\\end{aligned}\n$$\n\n- An **assignment** of the variables $x_1, x_2, \\ldots, x_n$ is a **solution** of the linear system if it satisfies **all** $m$ equations simultaneously.  \n- A linear system that has **at least one solution** is called **consistent**.  \n- A linear system with **no solution** is called **inconsistent**.  \n- A system is **underdetermined** if there are **more variables than equations** ($n > m$).  \n- A system is **overdetermined** if there are **more equations than variables** ($m > n$).  \n\n:::\n\nHere are some questions about linear systems that we will soon be able to answer.\n\n1. What are the possible sizes of the solution set of a linear system?\n2. How do we tell if a linear system is consistent?\n3. How can we tell if a consistent linear system has a unique solution?\n4. How do we find all solutions of a consistent linear system?\n5. How can we find an approximate solution to an inconsistent linear system?\n\nThe answers to these questions are not obvious.  For example, given what we have seen so far about linear systems it seems intuitive to conclude that any overdetermined linear system is inconsistent.  Since the following linear system is consistent with solution $x = 1$, $y=1$, \nthat intuition is incorrect. \n\n$$\n\\begin{aligned}\nx + y &= 2 \\\\\nx - y &= 0 \\\\\n2x + 3y &= 5\n\\end{aligned}\n$$\n\nTo answer these questions and more we will first need to learn about *matrices* and *vectors*.\nFor example, a linear system \ncan be written much more consisely using matrices and vectors as:\n\n$$\nA \\mathbf{x} = \\mathbf{b}\n$$\n\nwhere:\n\n$$\nA = \\begin{bmatrix}\na_{11} & a_{12} & \\cdots & a_{1n} \\\\\na_{21} & a_{22} & \\cdots & a_{2n} \\\\\n\\vdots & \\vdots & \\ddots & \\vdots \\\\\na_{m1} & a_{m2} & \\cdots & a_{mn}\n\\end{bmatrix}, \\quad\n\\mathbf{x} =\n\\begin{bmatrix}\nx_1 \\\\\nx_2 \\\\\n\\vdots \\\\\nx_n\n\\end{bmatrix}, \\quad\n\\mathbf{b} =\n\\begin{bmatrix}\nb_1 \\\\\nb_2 \\\\\n\\vdots \\\\\nb_m\n\\end{bmatrix}\n$$\n\nand \n\n- $A$ is called the *coefficient matrix*\n- $\\mathbf{x}$ is called the *solution vector*\n- $\\mathbf{b}$ is called the *right-and-side vector*\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"code-fold":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":false,"output-file":"section1_intro_linear_systems.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.31","theme":"cosmo","title":"1.1 Introduction to Linear Systems","author":"Jason R. Wilson","jupyter":"python3"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"code-fold":true,"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"section1_intro_linear_systems.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"block-headings":true,"documentclass":"scrreprt","title":"1.1 Introduction to Linear Systems","author":"Jason R. Wilson","jupyter":"python3"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}